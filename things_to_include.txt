1. Acronyms used in this document
FSK - Frequency Shift Keying
4FSK - Quaternary FSK
BPS - Bits Per Second
PTT - Push To Talk
V+D - Voice plus Data
AES - Advanced Encryption Standard
CTR - Counter (stream cipher mode)
LICH - Link Information CHannel
ECC - Error Correction Coding
SSN - Stream/Superframe Sequence Number (TODO: rename this to FN - Frame Number)
CRC - Cyclic Redundancy Check

2. Every transmission starts with a PREAMBLE, which shall consist of at least 40ms of alternating -3, +3... symbols.

3. Bit types:
Type 1 - raw data
Type 2 - type 1 bits after appropriate encoding
Type 3 - type 2 bits after puncturing (only for convolutionally coded data, for other ECC schemes type 3 bits are the same as type 2 bits)
Type 4 - interleaved (re-ordered) type 3 bits, the re-ordering scheme is given in another chapter

Type 4 bits are used for transmission over the RF. Incoming type 4 bits shall be decoded to type 1 bits, which are then used
to extract all the frame fields.

4. Frame 1 fields (Type 1 bits):
DST   - destination address			- 48 bits, encoded callsign or a special number (eg. a group)
SRC   - source address				- 48 bits, encoded callsign of the originator or a special number (eg. a group)
TYPE  - type						- 16 bits, information about incoming data stream:
											bit 0 		- packet/stream indicator, 0=packet, 1=stream
											bit 2,3 	- data type indicator, 01=data (D), 10=voice (V), 11=V+D, 00=reserved
											bit 4 		- voice codec indicator, 0=Codec2 1=other
											bit 5		- voice codec bitrate, 0=3200bps, 1=other
											bit 6,7 	- encryption type, 00=none, 01=AES, 10=scrambling, 11=other/reserved
											bits 8..15	- reserved (don't care)
NONCE - nonce value for encryption - 128 bits
TAIL  - 4 flushing bits for the convolutional encoder

These fields (except TAIL) form initial LICH. It contains all information needed to establish M17 link. Later in the transmission,
this channel is divided into 5 "chunks" and transmitted interleaved with data. The purpose of that is to allow late-joiners
to receive the LICH at any point of the transmission. The process of collecting full LICH takes 6 frames, that's 6*40 ms = 240 ms.
Four TAIL bits are needed for the convolutional coder to go back to state 0, so also the ending trellis position is known.

5. Frames 2, 3, 4, 5 fields:
SYNC    - synchronization burst		- 16 bits (0x3243), first 16-bit part of pi in hexadecimal notation
LICH    - LICH chunk, one of 5		- 48 bits, part of full LICH
SSN     - frame number				- 16 bits, starts from 0 and increments every frame
PAYLOAD - payload/data				- 128 bits, can contain arbitrary data
CRC     - CRC						- 16 bits, this field contains 16-bit value used to check data integrity, CRC-16 is used
TAIL    - 4 flushing bits for the convolutional encoder that don't carry any information

6. Frame 6 fields (Type 1 bits):
SYNC     - synchronization burst		- 16 bits (0x3243), first 16-bit part of pi in hexadecimal notation
PAYLOAD  - payload/data					- 128 bits, can contain arbitrary data
PREAMBLE - preamble for late-joiners	- 240 bits, 25 ms of alternating -3, +3... symbols

7. Superframe structure
A superframe contains 6 frames. At the beginning of the transmission, a leading PREAMBLE is sent. Immediately after that, a superframe starts. 
First frame has SSN field equal to 0 (zero). 6 consecutive frames are transmitted with no pauses in between. The last 25 milliseconds
of the superframe is the PREAMBLE for late-joiners. Every other superframes have identical structure. 15 milliseconds PREAMBLE marks the end
of the transmission.

8. Error coding schemes and bit type conversion
8.1 Frame 1:
240 DST, SRC, TYPE and NONCE type 1 bits are convolutionally coded using rate 1/2 coder with constraint K=5. 4 tail bits are used to flush
the encoder's state register, giving a total of 244 bits being encoded. Resulting 488 type 2 bits are retained for type 3 bits computation.
Type 3 bits are computed by puncturing type 2 bits using a scheme shown in chapter X. This results in 368 bits, which in conjunction with
the SYNC field give 384 bits (384 bits / 9600bps = 40 ms).
Interleaving type 3 bits produce type 4 bits that are ready to be transmitted. Interleaving is used to combat error bursts.

8.2 Frames 2 through 5:
A 48-bit (type 1) chunk of LICH is partitioned into 4 12-bit parts and encoded using Golay (24, 12) code. This produces 96 encoded LICH bits of type 2.
164 SSN, PAYLOAD and CRC bits are convolutionally encoded in a manner analogous to that of Frame 1. A total of 168 bits is being encoded resulting in
336 type 2 bits. These bits are punctured to generate 272 type 3 bits. 96 type 2 bits of LICH are concatenated with 272 type 3 bits and re-ordered to form
type 4 bits for transmission. This, along with 16-bit sync in the beginning of frame, gives a total of 384 bits.

8.3 Frame 6:
128-bit PAYLOAD is encoded convolutionally with rate 1/2, giving 256 type 2 bits. Puncturing type 2 bits shall give 224 type 3 bits. These bits
don't need to be re-ordered and can be treated like type 4 bits for transmission. 16-bit SYNC with 224-bit data gives 15 ms space for superframe ending PREAMBLE.